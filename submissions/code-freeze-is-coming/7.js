function f(o,r){function s(o){var r=t.floor,s=-1;for(var a in t.pass)t.pass.hasOwnProperty(a)&&(1===o&&a>r&&(-1===s||s>a)||-1===o&&r>a&&(-1===s||a>s))&&(s=a);return s}function a(o,r,s){if(o){var a=s,f=o.split("|");a&&a>=4&&a++,f.forEach(function(o){var s=o.split(":");void 0===a?r.pass[s[1]]=Number(s[0]):(void 0===r[a]&&(r[a]={}),r[a][s[1]]=Number(s[0]))})}}function f(o,r,s){for(var a in r)r.hasOwnProperty(a)&&(1===s&&a>o.floor||-1===s&&a<o.floor)&&(void 0!==o.pass[a]?o.pass[a]+=r[a]:o.pass[a]=r[a],delete r[a])}function e(o){var r=0;for(var s in o)o.hasOwnProperty(s)&&(r+=o[s]);return r}var l=o.split("\n").reverse(),n=l.length,t={floor:0,pass:{}},p=1,i="polite",v=0;a(l[0],t);for(var u={},c=1;c<l.length;c++)a(l[c],u,c);var h=!1;for(e(t.pass)<r&&(h=!0,t.floor=s(p));h&&10>v;){v++,delete t.pass[t.floor];var d=u[t.floor];f(t,d,p);var y=e(t.pass);if(y>=r){i="polite",h=!1;break}(0===y||t.floor===n)&&(p*=-1,f(t,d,p),0===e(t.pass)?(i="lonely",h=!1):e(t.pass)>=r&&(i="polite",h=!1)),-1!==s(p)&&h&&(t.floor=s(p))}console.log(i+" after "+v+" stops at "+t.floor+" floor")}