static void f(string p, int w, int h){var l=p.Split('\n');int x=0,y=0,d=1;bool V=true,H=V;var C=new List<string>();for(;;){var s=""+x+V+y+H+d;if(C.Contains(s)){Console.Write(8);break;}C.Add(s);int k=0,v=0,u=0,U=0;for (int i=x>0?x:0;i<x+w&&i<l[0].Length;i++)for (int j=y>0?y:0;j<y+h&&j<l.Length;j++){var c=l[j][i];if(c=='v')v++;if(c=='^')v--;if(c=='>')k++;if(c=='<')k--;if(c=='h')u--;if(c=='H')u++;if(c=='w')U--;if(c=='W')U++;}if(u!=0)H=u>0;if(U!=0)V=U>0;k=H?k:0;v=V?v:0;if ((k|v)==0){Console.Write(9);break;}Func<int, int> S = i => i < 0 ? -1 : 1;if(k*k>v*v)d=S(k);else if(k*k<v*v)d=S(v)*2;else d=((d&1)==1)?S(k):S(v)*2;x+=d%2;y+=d/2;}}