static int T=1000;static long[]l=new long[T*T],p=new long[T*T];static int c=0,s=-1;static boolean f=1<2;static void f(String b,int k){String[]r=b.split("\n");String[]q=new String[r.length+1];if(r.length>4){int m=0;for(int i=0;i<r.length;i++){if(i==r.length-4){q[m]="";m++;}q[m]=r[i];m++;}}else q=r;for(int i=q.length-1;i>=0;i--){int g=q.length-i-1;String[] u=q[i].split("\\|");if(q[i].isEmpty())continue;for(int j=0;j<u.length;j++){String e=u[j];p[g*T+j]=Integer.valueOf(e.split(":")[0])*T+Integer.valueOf(e.split(":")[1]);}}boolean u=1<2,v=u;int w=0;for(;;){if(w==0)v=1<2;if(x(w,l)){s++;e(u,k,w);if(u&&w>=m(l)){v=2<1;e(v,k,w);}if(!f && c==0){System.out.println("lonely after "+s+" stops at "+w+" floor");System.exit(0);}}u=v;if(u)w++;else w--;f=2<1;}}static long m(long[]l){long m=1;for(int i=0;i<T*T;i++)if(m<l[i]%T)m=(int)(l[i]%T);return m;}static void e(boolean u,int k,int w){for(int i=w*T;i<w*T+T;i++){if(p[i]%T>w^!u){a(p[i],k,w);p[i]=0;}}}static void a(long p,int k,int w){for(int i=0;1<2;i++){if(l[i]==0){l[i]=p;c+=p/T;if(c>k-1){System.out.println("polite after "+s+" stops at "+w+" floor");System.exit(0);}return;}}}static boolean x(int w,long[]l){int x=0;for(int i=0;i<l.length;i++)if(l[i]%T==w){x+=l[i]/T;l[i]=0;}c-=x;return f||x>0;}